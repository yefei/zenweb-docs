# 项目演练：做一个小 Blog

下面将上面所学组合一下，做一个小型 Blog

项目要求：
  - 需要用户登录认证
  - 可以查看博客列表，新增、详情、删除

为了能真实完成业务逻辑，我们先做一点点准备，建立一个数据访问层。

```ts title="src/model/blog.ts"
// 这里为了测试方便，数据存储使用本地变量，实际情况应该是存储在数据库中
// 使用 ZenORM 下面这些代码都不需要创建，ORM 系统内置丰富方法。感兴趣可以查看 ZenORM 文档

export interface Blog {
  id: number;
  title: string;
  content: string;
  created: Date;
}

let lastId = 0;
const list: Blog[] = [];

export class BlogStore {
  getAll() {
    return list;
  }

  getById(id: number) {
    return list.find(i => i.id === id);
  }

  create(data: { title: string, content: string }) {
    list.push({
      id: lastId++,
      created: new Date(),
      ...data,
    });
  }

  removeById(id: number) {
  }
}
```

创建 Blog 控制器

```ts title="src/controller/blog.ts"
import { Context, controller, mapping, inject } from "zenweb";
import { BlogStore } from "../model/blog";

@controller({
  prefix: "/blog",
})
export class BlogController {
  @inject ctx: Context;
  @inject blogStore: BlogStore;

  @mapping()
  list() {
    this.ctx.success(this.blogStore.getAll());
  }

  getParamId() {
    return this.ctx.helper.param({ id: "!int" }).id;
  }

  @mapping({ path: "/:id(\d+)" })
  detail(ctx: Context) {
    const id = this.getParamId();
    const blog = this.blogStore.getById(id);
    this.ctx.success(blog);
  }

  @mapping({ method: "POST" })
  create() {
    this.ctx.helper.query({ id: "!int" }).id;
  }

  @mapping({ path: "/:id(\d+)", method: "DELETE" })
  remove(ctx: Context) {
    const id = this.getParamId();
  }
}
```
